## HTTP连接

* [一文搞懂http](https://juejin.im/post/5e1870736fb9a02fef3a5dcb#heading-14)
* [http状态码301和302详解及区别——辛酸的探索之路](https://blog.csdn.net/grandPang/article/details/47448395)
* [看完这篇HTTP，跟面试官扯皮就没问题了](https://juejin.im/post/5e1870736fb9a02fef3a5dcb)
* []()

HTTP协议即超文本传送协议(Hypertext Transfer Protocol )，是Web联网的基础，也是手机联网常用的协议之一，HTTP协议是建立在TCP协议之上的一种应用。
HTTP连接最显著的特点是客户端发送的每次请求都需要服务器回送响应，在请求结束后，会主动释放连接。从建立连接到关闭连接的过程称为“一次连接”。

* 1）在HTTP 1.0中，客户端的每次请求都要求建立一次单独的连接，在处理完本次请求后，就自动释放连接。

* 2）在HTTP 1.1中则可以在一次连接中处理多个请求，并且多个请求可以重叠进行，不需要等待一个请求结束后再发送下一个请求。

由于HTTP在每次请求结束后都会主动释放连接，因此HTTP连接是一种“短连接”，要保持客户端程序的在线状态，需要不断地向服务器发起连接请求。通常 的做法是即时不需要获得任何数据，客户端也保持每隔一段固定的时间向服务器发送一次“保持连接”的请求，服务器在收到该请求后对客户端进行回复，表明知道 客户端“在线”。若服务器长时间无法收到客户端的请求，则认为客户端“下线”，若客户端长时间无法收到服务器的回复，则认为网络已经断开。
点

## http 302状态码

官方的比较简洁的说明：

        301 redirect: 301 代表永久性转移(Permanently Moved)
        302 redirect: 302 代表暂时性转移(Temporarily Moved )

 详细来说，301和302状态码都表示重定向，就是说浏览器在拿到服务器返回的这个状态码后会自动跳转到一个新的URL地址，这个地址可以从响应的Location首部中获取（用户看到的效果就是他输入的地址A瞬间变成了另一个地址B）——这是它们的共同点。他们的不同在于。301表示旧地址A的资源已经被永久地移除了（这个资源不可访问了），搜索引擎在抓取新内容的同时也将旧的网址交换为重定向之后的网址；302表示旧地址A的资源还在（仍然可以访问），这个重定向只是临时地从旧地址A跳转到地址B，搜索引擎会抓取新的内容而保存旧的网址。

#### 1、什么是重定向啊？

    就是地址A跳转到地址B啦。百度百科的解释：重定向(Redirect)就是通过各种方法将各种网络请求重新定个方向转到其它位置（如：网页重定向、域名的重定向、路由选择的变化也是对数据报文经由路径的一种重定向）。

#### 2、可是，为什么要进行重定向啊？什么时候需要重定向呢？

还是借鉴百度百科：

* 1）网站调整（如改变网页目录结构）；
* 2）网页被移到一个新地址；
* 3）网页扩展名改变(如应用需要把.php改成.Html或.shtml)。

        这种情况下，如果不做重定向，则用户收藏夹或搜索引擎数据库中旧地址只能让访问客户得到一个404页面错误信息，访问流量白白丧失；再者某些注册了多个域名的网站，也需要通过重定向让访问这些域名的用户自动跳转到主站点等。

## HTTP 状态码 302，301，304的的区别？

301 moved permanently、302 found、303 see other

301/302/303都表示重定向，所以放在一起讲解。

* 301表示永久重定向（301 moved permanently），表示请求的资源分配了新url，以后应使用新url。

* 302表示临时性重定向（302 found），请求的资源临时分配了新url，本次请求暂且使用新url。302与301的区别是，302表示临时性重定向，重定向的url还有可能还会改变。

* 303 表示请求的资源路径发生改变，使用GET方法请求新url。她与302的功能一样，但是明确指出使用GET方法请求新url。

* 304 not modified 客户端发送附带条件的请求时（if-matched,if-modified-since,if-none-match,if-range,if-unmodified-since任一个）服务器端允许请求访问资源，但因发生请求未满足条件的情况后，直接返回304Modified（服务器端资源未改变，可直接使用客户端未过期的缓存）。304状态码返回时，不包含任何响应的主体部分。304虽然被划分在3xx类别中，但是和重定向没有关系。

* 400 bad request

表示请求的报文中存在语法错误，比如url含有非法字符。

提交json时，如果json格式有问题，接收端接收json，也会出现400 bad request

比如常见的json串，数组不应该有",但是有"了。

错误的json

* 405 method not allowed

问题原因：  请求的方式（get、post、delete）方法与后台规定的方式不符合。

比如： 后台方法规定的请求方式只接受get，如果用post请求，就会出现 405 method not allowed的提示


* 415 后台程序不支持提交的content-type，就会返回415，spring mvc错误信息如下

The server refused this request because the request entity is in a format not supported by the requested resource for the requested method.

unsupported media type


新url指的是，第一次请求返回的location。

举例说明

1、浏览器访问http://write.blog.csdn.net, csdn中“我的博客”

2、服务器，返回状态码 302（url临时改变）和location

3、浏览器，请求location指定的地址，完成请求。也就是说，浏览器一共请求了2次！



以 `2xx` 为开头的都表示请求成功响应。

| 状态码 | 含义                                                         |
| ------ | ------------------------------------------------------------ |
| 200    | 成功响应                                                     |
| 204    | 请求处理成功，但是没有资源可以返回                           |
| 206    | 对资源某一部分进行响应，由Content-Range 指定范围的实体内容。 |

以 `4xx` 的响应结果表明客户端是发生错误的原因所在。

| 状态码 | 含义                                                         |
| ------ | ------------------------------------------------------------ |
| 400    | 该状态码表示请求报文中存在语法错误。当错误发生时，需修改请求的内容后再次发送请求。 |
| 401    | 该状态码表示发送的请求需要有通过 HTTP 认证（BASIC 认证、DIGEST 认证）的认证信息。 |
| 403    | 该状态码表明对请求资源的访问被服务器拒绝了。                 |
| 404    | 该状态码表明服务器上无法找到请求的资源。                     |

以 `5xx` 为开头的响应标头都表示服务器本身发生错误

| 状态码 | 含义                                                         |
| ------ | ------------------------------------------------------------ |
| 500    | 该状态码表明服务器端在执行请求时发生了错误。                 |
| 503    | 该状态码表明服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。 |

下面是一个响应头的汇总，基于 HTTP 1.1

![img](https://user-gold-cdn.xitu.io/2020/1/10/16f8f773ffb5140f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

## HTTP 的优点和缺点

### HTTP 的优点

#### 简单灵活易扩展

HTTP 最重要也是最突出的优点是 **简单、灵活、易于扩展**。

HTTP 的协议比较简单，它的主要组成就是 `header + body`，头部信息也是简单的文本格式，而且 HTTP 的请求报文根据英文也能猜出来个大概的意思，降低学习门槛，能够让更多的人研究和开发 HTTP 应用。

所以，在简单的基础上，HTTP 协议又多了`灵活` 和 `易扩展` 的优点。

HTTP 协议里的请求方法、URI、状态码、原因短语、头字段等每一个核心组成要素都没有被制定死，允许开发者任意定制、扩充或解释，给予了浏览器和服务器最大程度的信任和自由。

#### 应用广泛、环境成熟

因为过于简单，普及，因此应用很广泛。因为 HTTP 协议本身不属于一种语言，它并不限定某种编程语言或者操作系统，所以天然具有**跨语言、跨平台**的优越性。而且，因为本身的简单特性很容易实现，所以几乎所有的编程语言都有 HTTP 调用库和外围的开发测试工具。

随着移动互联网的发展， HTTP 的触角已经延伸到了世界的每一个角落，从简单的 Web 页面到复杂的 JSON、XML 数据，从台式机上的浏览器到手机上的各种 APP、新闻、论坛、购物、手机游戏，你很难找到一个没有使用 HTTP 的地方。

#### 无状态

无状态其实既是优点又是缺点。因为服务器没有记忆能力，所以就不需要额外的资源来记录状态信息，不仅实现上会简单一些，而且还能减轻服务器的负担，能够把更多的 CPU 和内存用来对外提供服务。

### HTTP 的缺点

#### 无状态

既然服务器没有记忆能力，它就无法支持需要连续多个步骤的`事务`操作。每次都得问一遍身份信息，不仅麻烦，而且还增加了不必要的数据传输量。由此出现了 `Cookie` 技术。

#### 明文

HTTP 协议里还有一把优缺点一体的双刃剑，就是**明文传输**。明文意思就是协议里的报文（准确地说是 header 部分）不使用二进制数据，而是用简单可阅读的文本形式。

对比 TCP、UDP 这样的二进制协议，它的优点显而易见，不需要借助任何外部工具，用浏览器、Wireshark 或者 tcpdump 抓包后，直接用肉眼就可以很容易地查看或者修改，为我们的开发调试工作带来极大的便利。

当然缺点也是显而易见的，就是`不安全`，可以被监听和被窥探。因为无法判断通信双方的身份，不能判断报文是否被更改过。

#### 性能

HTTP 的性能不算差，但不完全适应现在的互联网，还有很大的提升空间。
