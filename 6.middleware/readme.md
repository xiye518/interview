# 6.中间件

中间件，微服务，rabbitmq、kafka、k8s、docker、etcd、grpc、Prometheus、nginx，熔断、限流组件，网关，负载均衡；

* [go-kit微服务：服务注册与发现](https://juejin.im/post/5c740a335188257c1e2c86a7)
* [面试都在问的微服务、服务治理、RPC、下一代微服务... 一文带你彻底搞懂！](https://juejin.im/post/5e898dfde51d45471263e110)
* [golang consul-grpc 服务注册与发现](https://studygolang.com/articles/13293)
* [用 etcd 实现服务注册和发现](https://learnku.com/articles/37344)
* 图灵社区 [1　Etcd简介](https://www.ituring.com.cn/book/tupubarticle/16499)
* [终于有人把微服务架构讲清了！这估计是史上最全的一篇微服务实战](https://zhuanlan.zhihu.com/p/130898563)
* []()

## 网关，LB，nginx

## 服务注册与发现，etcd，raft一致性算法

系统中实现服务注册与发现所需的基本功能有

* 服务注册：同一 service 的所有节点注册到相同目录下，节点启动后将自己的信息注册到所属服务的目录中。
* 健康检查：服务节点定时发送心跳，注册到服务目录中的信息设置一个较短的 TTL，运行正常的服务节点每隔一段时间会去更新信息的 TTL。
* 服务发现：通过名称能查询到服务提供外部访问的 IP 和端口号。比如网关代理服务时能够及时的发现服务中新增节点、丢弃不可用的服务节点，同时各个服务间也能感知对方的存在。

 在分布式系统中，如何管理节点间的状态一直是一个难题，etcd是CoreOS公司发起的一个开源项目，是一个`分布式`的高一致性的 键值存储系统，它使用 Go 语言编写，并通过 Raft 一致性算法处理日志复制以保证强一致性。etcd 像是专门为集群环境的服务发现和注册而设计，它提供了数据 TTL 失效、数据改变监视、多值、目录监听、分布式锁原子操作等功能，可以方便的跟踪并管理集群节点的状态。

在使用时，我们每次网关后面加一个服务，只需要向etcd`注册`该服务（其实就是 存一个值）然后向etcd 发送心跳，当etcd 没有检测到心跳就会 把这个键值对 删了(这整个动作是etcd里的租约模式)，网关那边 就只需要 watch 这个 key ，就能够知道 所有服务的所有动态了

提供配置共享和服务发现的系统比较多，其中最为大家熟知的是`Zookeeper`，而Etcd可以算得上是后起之秀了。在项目实现、一致性协议易理解性、运维、安全等多个维度上，Etcd相比Zookeeper都占据优势。


## 消息中间件，rabbitMQ。kafka

## grpc，进程间通信，

